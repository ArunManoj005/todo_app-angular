<div class="page">
  <header class="top-bar">
    <div class="title-block">
      <h1>Note.</h1>
    </div>

    <div class="top-actions">
      <div class="search-wrapper">
        <input
          type="text"
          placeholder="Search by title or content..."
          [(ngModel)]="searchTerm"
          (ngModelChange)="onSearchChange()"
        />
      </div>

      <button
        type="button"
        class="theme-toggle"
        (click)="toggleTheme()"
        [attr.aria-label]="isDark ? 'Switch to light mode' : 'Switch to dark mode'"
      >
        {{ isDark ? "â˜€ï¸" : "ğŸŒ™" }}
      </button>

      <button class="new-note-btn" type="button" (click)="newNote()">
        <span class="plus">+</span>
        <span>New Note</span>
      </button>
    </div>
  </header>

  <!-- Notes grid -->
  <main class="grid-shell">
    <section class="notes-grid-section" aria-label="Notes board">
      <p
        class="empty-state"
        *ngIf="(filteredNotes$ | async)?.length === 0"
      >
        No notes yet. Click <strong>New Note</strong> to get started.
      </p>

      <ul class="notes-grid">
        <li
          *ngFor="let note of filteredNotes$ | async"
          class="note-card"
          [class.active]="isCurrent(note)"
          [class.note-yellow]="note.color === 'yellow'"
          [class.note-blue]="note.color === 'blue'"
          [class.note-green]="note.color === 'green'"
          [class.note-default]="!note.color || note.color === 'default'"
          (click)="selectNote(note)"
        >

          <div class="note-inner">
            <div class="note-header">
              <h3 class="note-title">
                {{ note.title || "Untitled" }}
              </h3>

              <button
                class="pin-btn"
                type="button"
                title="Pin / Unpin"
                (click)="togglePin(note, $event)"
              >
                <span [class.pinned]="note.pinned">ğŸ“Œ</span>
              </button>
            </div>
            <img *ngIf="note.image" [src]="note.image" class="note-thumb"/>
            <p class="note-body">
              {{ note.content || "No content yet" }}
            </p>

            <div class="note-footer">
              <span class="note-date">
                Updated: {{ note.updatedAt | date : "short" }}
              </span>

              <button
                class="delete-btn"
                type="button"
                (click)="deleteNote(note.id, $event)"
              >
                Delete
              </button>
            </div>
          </div>
        </li>
      </ul>
    </section>
  </main>
</div>
